function getTextContents(e,t){let n="",a=!1;function o(e,t){e.childNodes&&function(e,t){for(var n,a=0;a<e.length;a++)"KSE:WIDGET"!=(n=e[a]).tagName&&(t&&s(n),n.childNodes&&o(n,t))}(e.childNodes,t)}function s(e){1===e.nodeType||3===e.nodeType&&(e.data=e.data.replace(/^\s+$/g,""),e.data&&(e.data.includes("window.adminAccountId")||(t&&(n+="<p>"),n+=e.data.trim(),t&&(n+="</p>"),(!a||"Material"!==e.data.trim()&&"Color"!==e.data.trim()&&"Band Color"!==e.data.trim()&&"Band Width"!==e.data.trim()&&"Size"!==e.data.trim()&&"Ships From"!==e.data.trim())&&(n+="\n"))))}return"product-sku"===e.className&&(a=!0),o(e,!0),n}function getTextContentsList(e,t){let n=[],a=!1;function o(e,t){e.childNodes&&function(e,t){for(var n,a=0;a<e.length;a++)"KSE:WIDGET"!=(n=e[a]).tagName&&(t&&s(n),n.childNodes&&o(n,t))}(e.childNodes,t)}function s(e){1===e.nodeType||3===e.nodeType&&(e.data=e.data.replace(/^\s+$/g,""),e.data&&(e.data.includes("window.adminAccountId")||(":"===e.data.trim()||"("===e.data.trim()||")"===e.data.trim()&&0!==n.length?n[n.length-1]+=e.data.trim():n.push(e.data.trim()))))}e.className,o(e,!0);let r="";var i;for(i in n)r+=(t?"<p>":"")+n[i]+(t?"</p>":"")+"\n";return r}function upperCaseFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function lowerCaseAllWordsExceptFirstLetters(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0)+e.slice(1).toLowerCase()})}function makeSKU(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t}var cs_feedback_str="<p>Customer Service:</p>\n<p>We are here to help and listen for any issue regarding the product because your sastification is our motivation and target.</p>\n<p>Please contact us if you have any issues before leaving any comments / feedback on Amazon, our dear customer:</p>\n<p>1. You are not happy with our product</p>\n<p>2. The package of product has any problem during shipping</p>\n<p>3. Any issues will be always welcome and they help us to improve our service</p>\n<p>Feedback:</p>\n<p>If you are happy with our product, please help to leave a rate of 5-star for us!</p>\n<p>Its a big motivation for us to bring more good products and services to customer!</p>\n",cs_feedback_str_1="<p>Feedback:</p>\n<p>- If you are satisfied with our product and service, please leave us positive feedback &amp; a 5-star review!</p>\n<p>- If your are unhappy with our service or any other problem, please contact us before leaving feedback and we will resolve the issue immediately, thank you!</p>\n",cs_feedback_str_2="<p>Feedback:</p>\n<p>Your feedback is very important for us to improve our service!</p>\n<p>- If you have any issues regarding the product, please contact us before leaving feedback, we will resolve it immediately!</p>\n<p>- If you are satisfined with our product, please give us feedback and rate 5-star review for us!</p>\n<p>Thank you!</p>\n";class domTask{static start(){this.setDownloadImages()}static download(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}static setDownloadImages(){let e=600;$(".img-view-wrap:eq(0)").prepend('<input type="button" style="'+this.btnStyles+'"  id="downloadImagesBtn" value="Download" />'),$("#downloadImagesBtn").click(()=>{$("#downloadImagesBtn").remove(),window.scrollTo(0,1e3),chrome.runtime.sendMessage({checkExtensions:"checkExtensions"},t=>{if(t)window.open(chrome.extension.getURL("message.html"),"Message","width=800,height=500,resizable=false");else{this.showMessage("Loading ...",5e3);let t=document.getElementById("product-description");setTimeout(()=>{t.scrollIntoView()},10),setTimeout(()=>{let t,n=[],a=$(".product-title").text().trim(),o=a,s=$(".images-view-list img, .sku-property-list img, #product-description img"),r=makeSKU(15),i=document.getElementsByClassName("images-view-list")[0],d=document.getElementsByClassName("sku-property-list")[0],c=(document.getElementById("product-description"),1),l=1,p=1;s.each((o,s)=>{function u(e){let t=document.getElementsByClassName("image-viewer"),n=document.getElementsByClassName("product-sku");return t[0]&&t[0].contains(e)?"/ảnh_mô_tả_sản_phẩm":n[0]&&n[0].contains(e)?"/ảnh_biến_thể_màu":"/ảnh_trong_nội_dung"}try{let o=$(s).attr("src");if(o=o.split("?")[0],n.filter(function(e,t){return e==o}).length||-1===o.search(".jpg"))console.log("Exist");else{if(n.push(o),o.match(/.jpg/gi).length>1)try{o=o.substring(0,o.match(/.jpg/i).index+4)}catch(e){console.log(e.stack)}t=a.substring(0,10);let m=(new Date).toISOString().replace(/T|Z/g,"_").replace(/:/g,"").replace(".",""),g=0;i.contains(s)?(g=c,c++):d.contains(s)?(g=l,l++):(g=p,p++);let h=g+"_"+a+o.substring(o.lastIndexOf("."));o.substring(0,8).match("http")||(o="http:"+o),t="Aliexpress/"+m+document.URL.substring(0,document.URL.indexOf("?")).replace(/\D/g,"")+"_"+r,h=h.replace(/[^0-9^a-z^-^ ^_^.]/gi,"_"),e+=1e3,setTimeout(()=>{chrome.runtime.sendMessage({doDownload:{url:o,folderName:t+u(s),fileName:h}},e=>{console.log(e)})},e)}}catch(e){console.log(e.stack)}}),chrome.storage.sync.get(["brandName"],function(e){let n="";n=e.brandName;try{let e="";e="[PRODUCT NAME]\n",e+="============= \n",e+=n+" - "+o,e+="\n\n",e+="[PRODUCT TITLE]\n",e+="=============== \n",e+=n+" - "+o,e+="\n\n",e+="[BRAND NAME]\n",e+="============ \n",e+="N/A",e+="\n\n",e+="[MANUFACTURER, MANUFACTURER PART NUMBER]\n",e+="==================================================== \n",e+=n,e+="\n\n",e+="-------------------------------------------------------------------------------------------------------------\n\n",e+="[SELLER SKU]\n",e+="============ \n",e+=r,e+="\n\n",e+="[PRODUCT PRICE]\n",e+="=============== \n";let s=document.getElementsByClassName("product-price-value");var a;for(a=0;a<s.length;a++)s[a]&&(e+=s[a].innerHTML+"\n");e+="\n";let i=document.getElementsByClassName("product-sku");i[0]&&(e+="[PRODUCT SKU]\n",e+="============= \n",e+=getTextContentsList(i[0],!1),e+="\n");let d=document.getElementsByClassName("product-shipping-price");d[0]&&(e+="[SHIPPING FEE]\n",e+="============== \n",e+=getTextContentsList(d[0],!1),e+="\n");let c=document.getElementsByClassName("product-quantity-tip");c[0]&&(e+="[PRODUCT QUANTITY]\n",e+="================== \n",e+=getTextContentsList(c[0],!1),e+="\n"),e+="-------------------------------------------------------------------------------------------------------------\n\n";let l="",p=document.getElementsByClassName("product-description");p[0]&&(l+=getTextContentsList(p[0],!0)),e+="[PRODUCT DESCRIPTIONS] \n",e+="====================== \n",""===l&&(l="Chú ý: Nội dung miêu tả sản phẩm không có, vui lòng lấy tên sản phẩm hoặc tự viết thêm.\n"),e+=l,e+="\n"+cs_feedback_str_1,e+="\n",e+="-------------------------------------------------------------------------------------------------------------\n\n",e+="[SEARCH TERMS]\n",e+="============== \n",e+=o.toLowerCase(),e+="\n\n",e+="-------------------------------------------------------------------------------------------------------------\n\n",e+="[PRODUCT URL] \n",e+="============= \n",e+=document.URL.substring(0,document.URL.indexOf("?")),e+="\n\n",chrome.runtime.sendMessage({doDownload:{url:"data:text/plain;charset=utf-8,"+encodeURIComponent(e),folderName:t,fileName:"File thông tin sản phẩm.txt"}},e=>{console.log(e)})}catch(e){console.log(e.stack)}})},5e3)}})})}static showMessage(e,t=2e3){let n=document.createElement("div");n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.height="20px",n.style.width="100%",n.style.zIndex="999",n.style.background="darkorange",n.style.textAlign="center",n.style.color="#fff",n.innerHTML='<h2 style="background:darkorange;color:#fff !important;">'+e+"</h2>",document.body.appendChild(n),t||(t=2e3),setTimeout(()=>{n.remove()},t)}}domTask.btnStyles="\n            background: #ff4400;\n            color: #fff;\n            border: unset;\n            padding: 5px;\n            margin-bottom:5px;\n            margin-top: 5px;\n            cursor: pointer;\n    ",setTimeout(()=>{domTask.start()},1);